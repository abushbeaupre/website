[
  {
    "objectID": "case_study.html",
    "href": "case_study.html",
    "title": "Case Study",
    "section": "",
    "text": "Content for case study to be added."
  },
  {
    "objectID": "case_study.html#case-study",
    "href": "case_study.html#case-study",
    "title": "Case Study",
    "section": "",
    "text": "Content for case study to be added."
  },
  {
    "objectID": "simulations.html",
    "href": "simulations.html",
    "title": "Simulations",
    "section": "",
    "text": "Using simulations, we will explore how to visualize indirect effects when we have an exposure, mediator and outcome variable."
  },
  {
    "objectID": "simulations.html#load-packages",
    "href": "simulations.html#load-packages",
    "title": "Simulations",
    "section": "Load packages",
    "text": "Load packages\n\nlibrary(tidyverse) # data manipulation and plotting\nlibrary(glmmTMB) # frequentist glmms\nlibrary(patchwork) #multiple plots\nlibrary(marginaleffects) # marginal predictions\n\nset.seed(333) # set seed to reproduce the simulations exactly"
  },
  {
    "objectID": "simulations.html#dag-plotting-function",
    "href": "simulations.html#dag-plotting-function",
    "title": "Simulations",
    "section": "DAG plotting function",
    "text": "DAG plotting function\n\n#' Create a DAG plot with rounded boxes and arrows\n#'\n#' @param labels Character vector of length 3 with names for Exposure, Mediator, Outcome\n#' @param arrow_labels Character vector of length 4 with labels for paths B, C, D, E (default: c(\"B\", \"C\", \"D\", \"E\"))\n#' @param box_colors Character vector of length 3 with hex colors for boxes (default: c(\"#B22222\", \"#2E8B57\", \"#1E90FF\"))\n#' @param arrow_color Color for arrows (default: \"#0F6670\")\n#' @return A ggplot object\ncreate_dag_plot &lt;- function(labels = c(\"Exposure\", \"Mediator\", \"Outcome\"),\n                           arrow_labels = c(\"B\", \"C\", \"D\", \"E\"),\n                           box_colors = c(\"tomato4\", \"#2E8B57\", \"#1E90FF\"),\n                           arrow_color = \"#0F6670\") {\n  \n  # Path diagram (DAG) — rounded boxes + arrows\n  # boxes: name, center x/y, width, height, border colour\n  # Using wider coordinate system (0-1.4 for x) to create rectangular plot\n  boxes &lt;- data.frame(\n    name = labels,\n    x = c(0.7, 0.25, 1.15),\n    y = c(0.8, 0.4, 0.4),\n    width = c(0.7, 0.6, 0.6),\n    height = c(0.14, 0.18, 0.18),\n    col = box_colors,\n    stringsAsFactors = FALSE\n  )\n  \n  # arrow head style\n  arr_closed &lt;- grid::arrow(length = unit(0.22, \"inches\"), type = \"closed\")\n  arr_open &lt;- grid::arrow(length = unit(0.22, \"inches\"), type = \"open\")\n  \n  # Draw arrows FIRST so they appear behind boxes\n  p &lt;- ggplot() + xlim(0.2, 1.4) + ylim(0.2, 0.9) + \n    # B: Exposure -&gt; Outcome (right, curved)\n    geom_curve(aes(x = 0.81, y = 0.74, xend = 1.15, yend = 0.5), \n               curvature = -0.28, color = arrow_color, size = 1.4, arrow = arr_closed) +\n    # C: Exposure -&gt; Mediator (left, curved)\n    geom_curve(aes(x = 0.59, y = 0.74, xend = 0.25, yend = 0.5), \n               curvature = 0.28, color = arrow_color, size = 1.4, arrow = arr_closed) +\n    # D: Mediator -&gt; Outcome (bottom, long curve)\n    geom_curve(aes(x = 0.25, y = 0.31, xend = 1.15, yend = 0.3), \n               curvature = 0.32, color = arrow_color, size = 1.4, arrow = arr_closed) +\n    # E: dashed indirect (Exposure -&gt; Outcome via dashed curved line)\n    geom_curve(aes(x = 0.62, y = 0.765, xend = 0.84, yend = 0.41), \n               curvature = 1.5, color = \"slategray3\", size = 1.2,  arrow = arr_closed)\n  \n  # Now draw boxes on top of arrows\n  for(i in seq_len(nrow(boxes))){\n    bx &lt;- boxes[i,]\n    xmin &lt;- bx$x - bx$width/2\n    xmax &lt;- bx$x + bx$width/2\n    ymin &lt;- bx$y - bx$height/2\n    ymax &lt;- bx$y + bx$height/2\n    \n    # draw a rounded rectangle as a grob and place it with annotation_custom\n    rr &lt;- grid::roundrectGrob(r = unit(0.2, \"snpc\"),\n            gp = grid::gpar(fill = \"white\", col = bx$col, lwd = 6))\n    p &lt;- p + annotation_custom(rr, xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax) +\n      annotate(\"text\", x = bx$x, y = bx$y, label = bx$name, \n               fontface = \"bold\", size = 6, colour = bx$col)\n  }\n  \n  # Add labels for arrows on top\n  p &lt;- p +\n    annotate(\"text\", x = 1.00, y = 0.62, label = arrow_labels[1], size = 6, fontface = \"bold\") +\n    annotate(\"text\", x = 0.40, y = 0.62, label = arrow_labels[2], size = 6, fontface = \"bold\") +\n    annotate(\"text\", x = 0.70, y = 0.27, label = arrow_labels[3], size = 6, fontface = \"bold\") +\n    annotate(\"text\", x = 0.2, y = 0.7, label = arrow_labels[4], size = 6, fontface = \"bold\") +\n    coord_cartesian(clip = \"off\") +\n    theme_void()\n  \n  return(p)\n}"
  },
  {
    "objectID": "simulations.html#data",
    "href": "simulations.html#data",
    "title": "Simulations",
    "section": "Data",
    "text": "Data\n\nn &lt;- 3000 # sample size\nE &lt;- rnorm(n, 0, 1) # define E as a Z-score\nM &lt;- rpois(n, exp(4 + 0.1*E)) # M is a poisson variable whose link is the log function so defining the coefficients using the inverse log (exponential)\nO &lt;- rbinom(n, size = 1, prob = plogis(-3 + 0.1*E + 0.05*M)) # O is a Bernoulli variable whose link is the logit so defining the coefficients using the inverse logit (plogis)\n\ndata &lt;- tibble(\n  E = E,\n  M = M,\n  O = O,\n  O_1 = 1 - O\n)\n\nhead(data)\n\n# A tibble: 6 × 4\n        E     M     O   O_1\n    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;\n1 -0.0828    44     0     1\n2  1.93      71     1     0\n3 -2.05      45     0     1\n4  0.278     58     0     1\n5 -1.53      43     0     1\n6 -0.269     62     0     1"
  },
  {
    "objectID": "simulations.html#models",
    "href": "simulations.html#models",
    "title": "Simulations",
    "section": "Models",
    "text": "Models\nWe need two models: one where we regress the Mediator as a function of the Exposure. A second where we regress the Outcome as a function of both the Mediator and Exposure. ### M ~ E\n\nmM_E &lt;- glmmTMB(M ~ E, family = poisson, data = data)\n\n\nO ~ E + M\n\nmO_EM &lt;- glmmTMB(cbind(O, O_1) ~ E + M, family = binomial, data = data)"
  },
  {
    "objectID": "simulations.html#predictions",
    "href": "simulations.html#predictions",
    "title": "Simulations",
    "section": "Predictions",
    "text": "Predictions\n\nM ~ E\n\npred_M_E &lt;- predictions(mM_E, vcov = TRUE, newdata = datagrid(E = seq(from = min(data$E), to = max(data$E), length.out = 3000))) # need many points for the visualisation of the indirect effect later on\nhead(pred_M_E)\n\n\n     E Estimate Std. Error   z Pr(&gt;|z|)   S 2.5 % 97.5 %\n -3.51     38.1      0.352 108   &lt;0.001 Inf  37.4   38.7\n -3.50     38.1      0.352 108   &lt;0.001 Inf  37.4   38.8\n -3.50     38.1      0.351 108   &lt;0.001 Inf  37.4   38.8\n -3.50     38.1      0.351 108   &lt;0.001 Inf  37.4   38.8\n -3.50     38.1      0.351 108   &lt;0.001 Inf  37.4   38.8\n -3.50     38.1      0.351 109   &lt;0.001 Inf  37.4   38.8\n\nType: response\n\n\n\nPlot\n\npM_E &lt;- ggplot(data = pred_M_E) +\n  geom_line(aes(y = estimate, x = E), \n            lineend = \"round\",\n            linewidth = 1.5) +\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, x = E), \n              alpha = 0.2) +\n  geom_segment(y=min(pred_M_E$estimate), \n               x = min(pred_M_E$E)*1.3, \n               xend= min(pred_M_E$E), \n               linetype= \"dashed\") +\n  geom_segment(y=max(pred_M_E$estimate), \n               x = min(pred_M_E$E)*1.3, \n               xend= max(pred_M_E$E), \n               linetype= \"dashed\") +\n  scale_y_continuous(breaks = seq(from = 40, to = 80, by = 10))+\n  theme_classic() +\n  labs(title = NULL,\n       y = \"Mediator\",\n       x = \"Exposure\") + \n  coord_cartesian(xlim = c(-4,4)) +\n  theme(axis.line.y = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"aquamarine4\"),\n        axis.line.x = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"tomato4\"),\n        axis.ticks = element_blank(),\n        axis.title.x = element_text(color = \"tomato4\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.title.y = element_text(color = \"aquamarine4\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.text.x = element_text(face = \"bold\", \n                                   size = 14),\n        axis.text.y = element_text(face = \"bold\", \n                                    \n                                   size = 14),\n        plot.title = element_text(size = 16)) \n\npM_E\n\n\n\n\n\n\n\n\n\n\n\nO ~ E + M\n\n\nDirect effect of E\n\npred_O_E &lt;- predictions(mO_EM, vcov = TRUE, newdata = datagrid(E = seq(from = min(data$E), to = max(data$E), length.out = 30)))\nhead(pred_O_E)\n\n\n     E Estimate Std. Error     z Pr(&gt;|z|)     S 2.5 % 97.5 %\n -3.51    0.367     0.0399  9.21   &lt;0.001  64.8 0.289  0.445\n -3.26    0.373     0.0375  9.94   &lt;0.001  75.0 0.299  0.446\n -3.02    0.378     0.0351 10.78   &lt;0.001  87.6 0.309  0.447\n -2.77    0.383     0.0326 11.75   &lt;0.001 103.5 0.319  0.447\n -2.53    0.389     0.0302 12.89   &lt;0.001 123.9 0.330  0.448\n -2.29    0.394     0.0277 14.23   &lt;0.001 150.3 0.340  0.449\n\nType: response\n\n\n\nPlot\n\npO_E &lt;- ggplot(data = pred_O_E) +\n  geom_line(aes(y = estimate, x = E), linewidth = 1.5, lineend = \"round\") +\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, x = E), alpha = 0.05) +\n  \n  theme_classic() +\n  labs(title = NULL,\n       y = \"Outcome\",\n       x = \"Exposure\") +\n    theme(axis.line.y = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"dodgerblue1\"),\n        axis.line.x = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"tomato4\"),\n        axis.ticks = element_blank(),\n        axis.title.x = element_text(color = \"tomato4\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.title.y = element_text(color = \"dodgerblue1\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.text.x = element_text(face = \"bold\", \n                                   size = 14),\n        axis.text.y = element_text(\n                                   face = \"bold\", \n                                   size = 14),\n        plot.title = element_text(size = 16))\npO_E \n\n\n\n\n\n\n\n\n\n\n\nDirect effect of M\n\npred_O_M &lt;- predictions(mO_EM, vcov = TRUE, newdata = datagrid(M = seq(from = min(data$M), to = max(data$M), length.out = 30)))\nhead(pred_O_M)\n\n\n    M Estimate Std. Error     z Pr(&gt;|z|)     S 2.5 % 97.5 %\n 27.0    0.174     0.0216  8.06   &lt;0.001  50.3 0.132  0.216\n 29.3    0.191     0.0214  8.92   &lt;0.001  60.8 0.149  0.232\n 31.6    0.208     0.0209  9.94   &lt;0.001  74.9 0.167  0.249\n 33.9    0.227     0.0203 11.18   &lt;0.001  94.0 0.187  0.267\n 36.2    0.247     0.0194 12.72   &lt;0.001 120.7 0.209  0.285\n 38.6    0.268     0.0183 14.64   &lt;0.001 158.8 0.232  0.304\n\nType: response\n\n\n\nPlot\n\npO_M &lt;- ggplot(data = pred_O_M) +\n  geom_line(aes(y = estimate, x = M), linewidth = 1.5, lineend = \"round\") +\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, x = M), alpha = 0.05) +\n  \n  theme_classic() +\n  labs(title = NULL,\n       y = \"Outcome\",\n       x = \"Mediator\") +\n    theme(axis.line.y = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"dodgerblue1\"),\n        axis.line.x = element_line(arrow = arrow(\n                                               length = unit(0.15, \"inches\"),\n                                               ends = \"last\", \n                                               type = \"closed\"),\n                                   linewidth = 1.5,\n                                   color = \"aquamarine4\"),\n        axis.ticks = element_blank(),\n        axis.title.x = element_text(color = \"aquamarine4\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.title.y = element_text(color = \"dodgerblue1\", \n                                    size = 16, \n                                    face = \"bold\", \n                                    family = \"\", \n                                    lineheight = 1.5),\n        axis.text.x = element_text(\n                                   face = \"bold\", \n                                   size = 14),\n        axis.text.y = element_text(face = \"bold\", \n                                   size = 14),\n        plot.title = element_text(size = 16))\npO_M\n\n\n\n\n\n\n\n\nSo this is the direct effect of M on O. But, remember that M is caused by E so it may be of interest to see how E affects O indirectly, through M.\n\n\n\nIndirect effect of E\n\npM_E\n\n\n\n\n\n\n\n\nThe next step is actually quite simple. We generate predictions for O as a function of the predictions of M ~ E\n\npred_O_EM &lt;- predictions(mO_EM, vcov = TRUE, newdata = datagrid(M = pred_M_E$estimate))\nhead(pred_O_EM)\n\n\n    M Estimate Std. Error    z Pr(&gt;|z|)     S 2.5 % 97.5 %\n 38.1    0.264     0.0186 14.2   &lt;0.001 149.5 0.227  0.300\n 38.1    0.264     0.0186 14.2   &lt;0.001 149.6 0.227  0.300\n 38.1    0.264     0.0186 14.2   &lt;0.001 149.8 0.228  0.300\n 38.1    0.264     0.0186 14.2   &lt;0.001 150.0 0.228  0.300\n 38.1    0.264     0.0186 14.2   &lt;0.001 150.1 0.228  0.300\n 38.1    0.264     0.0186 14.2   &lt;0.001 150.3 0.228  0.301\n\nType: response\n\n\nNow, we need the values of E that were associated with the predicted values of M\n\npred_O_ME &lt;- pred_O_EM %&gt;%\n  select(-c(E)) %&gt;% #remove E; it's set to its mean as we don't need it\n  mutate(E = pred_M_E$E)\n\nhead(pred_O_ME)\n\n\n Estimate Std. Error    z Pr(&gt;|z|)     S 2.5 % 97.5 %\n    0.264     0.0186 14.2   &lt;0.001 149.5 0.227  0.300\n    0.264     0.0186 14.2   &lt;0.001 149.6 0.227  0.300\n    0.264     0.0186 14.2   &lt;0.001 149.8 0.228  0.300\n    0.264     0.0186 14.2   &lt;0.001 150.0 0.228  0.300\n    0.264     0.0186 14.2   &lt;0.001 150.1 0.228  0.300\n    0.264     0.0186 14.2   &lt;0.001 150.3 0.228  0.301\n\n\nNow, we simply superimpose both graphs of O ~ M\n\nPlot\n\nCOLS &lt;- alpha(colorRampPalette(c(\"seashell\",\"tomato3\"))(30),0.8)\n\npO_ME &lt;- pO_M + geom_line(data = pred_O_ME, aes(x = M, y = estimate, color = E, linewidth = E), lineend = \"round\") +\n  geom_segment(x=min(pred_O_ME$M), y = 0, yend= min(pred_O_ME$estimate), linetype= \"dashed\") +\n  geom_segment(x=max(pred_O_ME$M), y = 0, yend= max(pred_O_ME$estimate), linetype= \"dashed\") +\n  labs(title = NULL) + \n  scale_color_gradientn(colours = COLS, name = \"Exposure\") +\n  guides(linewidth = \"none\") +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.3, 0.75),\n        legend.direction = \"horizontal\",\n        legend.text = element_text(color = \"tomato4\", size = 12, face = \"bold\", family = \"\", lineheight = 1.5),\n        legend.title = element_text(color = \"tomato4\",size = 16, face = \"bold\", family = \"\", lineheight = 1.5),\n        legend.title.position = \"top\")\n\npO_ME"
  },
  {
    "objectID": "simulations.html#figure-for-publication",
    "href": "simulations.html#figure-for-publication",
    "title": "Simulations",
    "section": "Figure for publication",
    "text": "Figure for publication\n\n# Create right column with B and C stacked\nright_col_top &lt;- pO_E / pM_E\n\n# Create layout: DAG on left, right column on right for rows 1-2\ntop_section &lt;- (DAG_default | right_col_top) + plot_layout(widths = c(1, 1))\n\n# Row 3 has two plots side by side\nrow3 &lt;- pO_M + pO_ME + plot_layout(widths = c(0.7, 1))\n\n# Combine all\nfig_1 &lt;- top_section / row3 + \n  plot_layout(heights = c(2, 1)) +\n  plot_annotation(tag_levels = 'A') &\n  theme(plot.tag = element_text(size = 16, face = \"bold\"))\n\nfig_1"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Extending the causal inference toolkit for ecologists: A visualization method of indirect effects",
    "section": "",
    "text": "Allen Bush-Beaupré1, Simon Coroller-Chouraki1, Marc Bélisle1,2\n1Université de Sherbrooke, Département de biologie, Sherbrooke, Canada\n2Centre d’étude de la forêt (CÉF)\nAllen Bush-Beaupré: allen.bush-beaupre@usherbrooke.ca | ORCID: 0000-0001-6989-9278\nSimon Coroller-Chouraki: ORCID: 0000-0001-8721-3727\nMarc Bélisle: ORCID: 0000-0003-0657-6724\n\nWelcome to the webpage dedicated to visualizing indirect effects for a wide scope of use cases in causal and network analyses. Being ecologists, we have focused on applying the visualization method we developed to examples in ecology. The method can however be applied to all fields of research in which indirect effects are of interest. By leveraging commonly used software such as marginaleffects and ggplot2, our method can be easily integrated into most analysis workflows.\n\n\n\n\nFigure 1.(A) Directed acyclic graph of a simulated example of the direct effect of an exposure variable on an outcome variable and its indirect effect through a mediator. (B) Prediction of the direct effect of the exposure on the outcome. (C) Prediction of the direct effect of the exposure on the mediator. (D) Prediction of the direct effect of the mediator on the outcome. (E) Prediction of the indirect effect of the exposure on the outcome superimposed on the prediction of the direct effect of the mediator on the outcome.\n\n\n\nAbstract\nMuch ecological research focuses on how a given variable can affect another either directly or indirectly through the effect of one or more intervening variables in the context of causal inference and network analyses. Various methods to quantify the magnitude of these effects are available but are difficult to interpret in a meaningful way. We propose a method of visualizing indirect effects by means of plotting model predictions of an outcome in the presence of exposure and mediator variables. We demonstrate the method through simulations and apply them to a real-world example involving Tree Swallows (Tachycineta bicolor) and their obligatory hematophagous ectoparasites, Protocalliphora spp. bird blowflies. The simple procedure using commonplace software should prove instrumental to visualize and interpret relationships among variables involved in ecological mechanisms and can be seamlessly integrated to analysts’ workflows.\n\nThis is the link towards the preprint of our article describing the method on Biorxiv\nThis is the link to access and download the data used in the case study\n\n\n\nWe use simulations to display the method with a simple use case in the Simulations tab. In the Case Study tab, we show how to use the visualization method in the case of real world data and model in which the predictor variables have been scaled. This adds a subtle layer of complexity to the procedure but the code should help overcome this."
  }
]